<mah:MetroWindow xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
                 xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
                 xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
                 xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
                 xmlns:local="clr-namespace:NTech.Xm.Station.Views"
                 xmlns:mah="clr-namespace:MahApps.Metro.Controls;assembly=MahApps.Metro"
                 xmlns:converters="http://metro.mahapps.com/winfx/xaml/shared"
                 xmlns:iconPacks="http://metro.mahapps.com/winfx/xaml/iconpacks"
                 xmlns:System="clr-namespace:System;assembly=mscorlib"
                 xmlns:vm="clr-namespace:NTech.Xm.Station.ViewModels"
                 xmlns:Ctrls="clr-namespace:NTech.Xm.Station.Controls"
                 xmlns:Controls="clr-namespace:NTech.Base.Wpf.Controls;assembly=NTech.Base.Wpf"
                 xmlns:self="clr-namespace:NTech.Xm.Station.Models"
                 xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
                 xmlns:search="clr-namespace:NTech.Xm.Commons.Defines;assembly=NTech.Xm.Commons"
                 xmlns:e="http://schemas.microsoft.com/expression/2010/interactivity"
                 xmlns:behaviours="clr-namespace:NTech.Xm.Station.Utils"
                 xmlns:PrinterConverters="clr-namespace:NTech.Xm.Station.Converters.Printer"
                 xmlns:CommonConverters="clr-namespace:NTech.Xm.Station.Converters"
                 xmlns:TroughConverter="clr-namespace:NTech.Xm.Station.Converters.Trough"
                 x:Class="NTech.Xm.Station.Views.MainView"
                 mc:Ignorable="d"
                 Title="MainView"
                 TitleCharacterCasing="Upper"
                 Height="720"
                 Width="1280"
                 MinWidth="600"
                 MinHeight="400"
                 BorderThickness="1"
                 ResizeMode="CanResizeWithGrip"
                 WindowTransitionsEnabled="False"
                 d:DataContext="{d:DesignInstance vm:MainViewModel}"
                 d:DesignHeight="400"
                 d:DesignWidth="600"
                 WindowStartupLocation="CenterScreen"
                 GlowBrush="#1A1F2B"
                 Background="#D2DBE4"
                 TitleBarHeight="45"
                 Loaded="MetroWindow_Loaded">
    <!--D2DBE4, E9E9EC-->
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing">
            <i:InvokeCommandAction Command="{Binding ClosingCmd}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <mah:MetroWindow.Resources>
        <!--TreeView-->
        <Style x:Key="NTech.Wpf.TreeView"
               TargetType="{x:Type TreeView}">
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="BorderBrush"
                    Value="Gray" />
            <Setter Property="BorderThickness"
                    Value="1" />
            <Setter Property="Padding"
                    Value="0" />
            <Setter Property="Foreground"
                    Value="Black" />
            <Setter Property="ScrollViewer.HorizontalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.VerticalScrollBarVisibility"
                    Value="Auto" />
            <Setter Property="ScrollViewer.PanningMode"
                    Value="Both" />
            <Setter Property="Stylus.IsFlicksEnabled"
                    Value="False" />
            <Setter Property="VerticalContentAlignment"
                    Value="Center" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeView}">
                        <Border x:Name="Bd"
                                BorderBrush="{TemplateBinding BorderBrush}"
                                BorderThickness="{TemplateBinding BorderThickness}"
                                SnapsToDevicePixels="true">
                            <ScrollViewer x:Name="_tv_scrollviewer_"
                                          Background="{TemplateBinding Background}"
                                          CanContentScroll="false"
                                          Focusable="false"
                                          HorizontalScrollBarVisibility="{TemplateBinding ScrollViewer.HorizontalScrollBarVisibility}"
                                          Padding="{TemplateBinding Padding}"
                                          SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}"
                                          VerticalScrollBarVisibility="{TemplateBinding ScrollViewer.VerticalScrollBarVisibility}">
                                <ItemsPresenter />
                            </ScrollViewer>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="{DynamicResource {x:Static SystemColors.ControlBrushKey}}" />
                            </Trigger>
                            <Trigger Property="VirtualizingPanel.IsVirtualizing"
                                     Value="true">
                                <Setter Property="CanContentScroll"
                                        TargetName="_tv_scrollviewer_"
                                        Value="true" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="VirtualizingPanel.IsVirtualizing"
                         Value="true">
                    <Setter Property="ItemsPanel">
                        <Setter.Value>
                            <ItemsPanelTemplate>
                                <VirtualizingStackPanel />
                            </ItemsPanelTemplate>
                        </Setter.Value>
                    </Setter>
                </Trigger>
            </Style.Triggers>
        </Style>
        <!--ToggleButton-->
        <Style x:Key="ToggleStyle"
               TargetType="{x:Type ToggleButton}">
            <Setter Property="Width"
                    Value="36" />
            <Setter Property="Height"
                    Value="36" />
            <Setter Property="Focusable"
                    Value="False" />
            <Setter Property="IsTabStop"
                    Value="False" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type ToggleButton}">
                        <Border>
                            <Image x:Name="toggleImg"
                                   Source="{DynamicResource IMG_arrow_down}"
                                   RenderTransformOrigin="0.5,0.5">
                                <Image.RenderTransform>
                                    <RotateTransform Angle="-90" />
                                </Image.RenderTransform>
                            </Image>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsChecked"
                                     Value="True">
                                <Setter Property="RenderTransform"
                                        TargetName="toggleImg">
                                    <Setter.Value>
                                        <RotateTransform Angle="0" />
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--TreeViewItem-->
        <Style TargetType="{x:Type TreeViewItem}">
            <Setter Property="FocusVisualStyle"
                    Value="{x:Null}" />
            <Setter Property="Background"
                    Value="Transparent" />
            <Setter Property="Padding"
                    Value="10,0" />
            <Setter Property="BorderThickness"
                    Value="0" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type TreeViewItem}">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition MinHeight="23" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <Border x:Name="Bd"
                                    CornerRadius="3"
                                    BorderThickness="{TemplateBinding BorderThickness}"
                                    Background="{TemplateBinding Background}"
                                    Padding="{TemplateBinding Padding}"
                                    SnapsToDevicePixels="true">
                                <DockPanel LastChildFill="True"
                                           Margin="{Binding Converter={StaticResource TreeViewItemMarginConverter}, RelativeSource={RelativeSource TemplatedParent}}">
                                    <ToggleButton x:Name="Expander"
                                                  ClickMode="Press"
                                                  DockPanel.Dock="Left"
                                                  IsChecked="{Binding IsExpanded, RelativeSource={RelativeSource TemplatedParent}}"
                                                  Style="{StaticResource ToggleStyle}" />
                                    <ContentPresenter VerticalAlignment="Center"
                                                      x:Name="PART_Header"
                                                      ContentSource="Header"
                                                      SnapsToDevicePixels="{TemplateBinding SnapsToDevicePixels}" />
                                </DockPanel>
                            </Border>
                            <ItemsPresenter x:Name="ItemsHost"
                                            Grid.Row="1" />
                        </Grid>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver"
                                     Value="True"
                                     SourceName="Bd">
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="Lavender" />
                            </Trigger>
                            <Trigger Property="IsExpanded"
                                     Value="False">
                                <Setter Property="Visibility"
                                        Value="Collapsed"
                                        TargetName="ItemsHost" />
                            </Trigger>
                            <Trigger Property="HasItems"
                                     Value="false">
                                <Setter Property="Visibility"
                                        TargetName="Expander"
                                        Value="Hidden" />
                            </Trigger>
                            <Trigger Property="IsSelected"
                                     Value="true">
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="LightBlue" />
                                <Setter Property="Foreground"
                                        Value="Black" />
                            </Trigger>
                            <MultiTrigger>
                                <MultiTrigger.Conditions>
                                    <Condition Property="IsSelected"
                                               Value="true" />
                                    <Condition Property="IsSelectionActive"
                                               Value="false" />
                                </MultiTrigger.Conditions>
                                <Setter Property="Background"
                                        TargetName="Bd"
                                        Value="Transparent" />
                                <Setter Property="Foreground"
                                        Value="Black" />
                            </MultiTrigger>
                            <Trigger Property="IsEnabled"
                                     Value="false">
                                <Setter Property="Foreground"
                                        Value="Gray" />
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
        <!--Ellipse-->
        <Style x:Key="NTech.Wpf.Ellipse"
               TargetType="{x:Type Ellipse}">
            <Setter Property="Width"
                    Value="20" />
            <Setter Property="Height"
                    Value="20" />
            <Setter Property="Margin"
                    Value="5 0 5 0" />
            <Setter Property="Stroke"
                    Value="White" />
            <Setter Property="StrokeThickness"
                    Value="3" />
            <Setter Property="Fill">
                <Setter.Value>
                    <LinearGradientBrush>
                        <GradientStop Color="#FF49A256" />
                        <GradientStop Color="#FF11ED33"
                                      Offset="1" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>
        <!--Rectangle-->
        <Style x:Key="NTech.Wpf.Rectangle"
               TargetType="{x:Type Rectangle}">
            <Setter Property="Width"
                    Value="86" />
            <Setter Property="Height"
                    Value="26" />
            <Setter Property="Margin"
                    Value="5 0 15 0" />
            <Setter Property="Stroke"
                    Value="White" />
            <Setter Property="StrokeThickness"
                    Value="3" />
            <Setter Property="Fill">
                <Setter.Value>
                    <LinearGradientBrush>
                        <GradientStop Color="#FF49A256" />
                        <GradientStop Color="#FF11ED33"
                                      Offset="1" />
                    </LinearGradientBrush>
                </Setter.Value>
            </Setter>
        </Style>

        <PrinterConverters:PrinterStateToBackgroundConverter x:Key="PrinterStateToBackgroundConverter" />
        <PrinterConverters:PrinterStateToIconConverter x:Key="PrinterStateToIconConverter" />
        <PrinterConverters:PrinterStateToString2Converter x:Key="PrinterStateToString2Converter" />
        <PrinterConverters:PrinterStateToStringConverter x:Key="PrinterStateToStringConverter" />
        <PrinterConverters:PrinterStateToVisibilityConverter x:Key="PrinterStateToVisibilityConverter" />
        <PrinterConverters:PrinterStateToVisibility2Converter x:Key="PrinterStateToVisibility2Converter" />
        <PrinterConverters:PrinterStateToForegroundConverter x:Key="PrinterStateToForegroundConverter" />
        <PrinterConverters:PrinterStateToBooleanConverter x:Key="PrinterStateToBooleanConverter" />
        <PrinterConverters:PrinterStateToBoolean2Converter x:Key="PrinterStateToBoolean2Converter" />
        <PrinterConverters:PrinterStateToBoolean3Converter x:Key="PrinterStateToBoolean3Converter" />
        <PrinterConverters:MultiBoleanConverter x:Key="MultiBoleanConverter" />
        <PrinterConverters:MessageStateToForegroundConverter x:Key="MessageStateToForegroundConverter" />
        <CommonConverters:EnumDescriptionConverter x:Key="EnumDescriptionConverter" />
        <CommonConverters:SearchValueConverter x:Key="SearchValueConverter"/>
        <TroughConverter:IsCheckedReverseConverter x:Key="TroughStateToVisibilityConverter" />
        <TroughConverter:TroughStateToBooleanConverter x:Key="TroughStateToBooleanConverter" />
        <TroughConverter:TroughStateToForegroundConverter x:Key="TroughStateToForegroundConverter" />
        <TroughConverter:TroughStateToBoolean2Converter x:Key="TroughStateToBoolean2Converter" />
    </mah:MetroWindow.Resources>
    <mah:MetroWindow.InputBindings>
        <KeyBinding Key="F5"
                    Command="{Binding PressF5KeyCmd}" />
    </mah:MetroWindow.InputBindings>
    <mah:MetroWindow.RightWindowCommands>
        <mah:WindowCommands>
            <ToggleButton Name="TogbtnReconnect"
                          Margin="5"
                          Command="{Binding ReconnectCmd}">
                <ToggleButton.Template>
                    <ControlTemplate>
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Width="16"
                                                      Height="16"
                                                      VerticalAlignment="Center"
                                                      Kind="Refresh" />
                            <TextBlock Margin="5 0 5 0"
                                       VerticalAlignment="Center"
                                       FontSize="20"
                                       Text="LÀM MỚI HỆ THỐNG" />
                        </StackPanel>
                    </ControlTemplate>
                </ToggleButton.Template>
            </ToggleButton>
            <ToggleButton Name="TogbtnSettings"
                          Margin="5">
                <ToggleButton.Template>
                    <ControlTemplate>
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconModern Width="16"
                                                      Height="16"
                                                      VerticalAlignment="Center"
                                                      Kind="Settings" />
                            <TextBlock Margin="5 0 5 0"
                                       VerticalAlignment="Center"
                                       FontSize="20"
                                       Text="Cài đặt" />
                        </StackPanel>
                    </ControlTemplate>
                </ToggleButton.Template>
            </ToggleButton>
            <ToggleButton Name="TogbtnLogin"
                          Margin="5">
                <ToggleButton.Template>
                    <ControlTemplate>
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Width="16"
                                                        Height="16"
                                                        VerticalAlignment="Center"
                                                        Kind="Account" />
                            <TextBlock Margin="5 0 5 0"
                                       VerticalAlignment="Center"
                                       FontSize="20"
                                       Text="Đăng nhập" />
                        </StackPanel>
                    </ControlTemplate>
                </ToggleButton.Template>
            </ToggleButton>
            <ToggleButton Name="TogbtnAbout"
                          Margin="5">
                <ToggleButton.Template>
                    <ControlTemplate>
                        <StackPanel Orientation="Horizontal">
                            <iconPacks:PackIconMaterial Width="16"
                                                        Height="16"
                                                        VerticalAlignment="Center"
                                                        Kind="Information" />
                            <TextBlock Margin="5 0 5 0"
                                       VerticalAlignment="Center"
                                       FontSize="20"
                                       Text="Thông tin" />
                        </StackPanel>
                    </ControlTemplate>
                </ToggleButton.Template>
            </ToggleButton>
        </mah:WindowCommands>
    </mah:MetroWindow.RightWindowCommands>
    <mah:MetroWindow.Flyouts>
        <mah:FlyoutsControl>
            <mah:Flyout x:Name="flySettingsView"
                        MinWidth="450"
                        Background="#FF323232"
                        CloseButtonVisibility="Visible"
                        Header="Cài đặt"
                        IsModal="True"
                        IsOpen="{Binding ElementName=TogbtnSettings, Path=IsChecked, Mode=TwoWay}"
                        Position="Right"
                        IsOpenChanged="Flyout_IsOpenChanged">
                <Ctrls:SettingsView Margin="10"
                                    x:Name="settingsView" />
            </mah:Flyout>
            <mah:Flyout x:Name="flyLoginView"
                        MinWidth="450"
                        Background="#FF323232"
                        CloseButtonVisibility="Visible"
                        DataContext="{Binding}"
                        Header="Đăng nhập"
                        IsModal="True"
                        IsOpen="{Binding ElementName=TogbtnLogin, Path=IsChecked, Mode=TwoWay}"
                        Position="Right">

                <Ctrls:LoginView x:Name="loginView"
                                 VerticalAlignment="Top"
                                 Margin="10" />
            </mah:Flyout>
            <mah:Flyout MinWidth="450"
                        Width="800"
                        Background="#FF323232"
                        CloseButtonVisibility="Visible"
                        DataContext="{Binding}"
                        Header="Thông tin"
                        IsModal="True"
                        IsOpen="{Binding ElementName=TogbtnAbout, Path=IsChecked, Mode=TwoWay}"
                        Position="Right">
                <Grid Height="600">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="80" />
                        <RowDefinition />
                    </Grid.RowDefinitions>
                    <StackPanel Orientation="Vertical">
                        <TextBlock Text="Copyright @2022 by NTech"
                                   Margin="20 0 0 0"
                                   FontSize="26"
                                   FontStyle="Italic" />
                        <TextBlock Text="Bản quyền thuộc về NTech. Mọi chi tiết xin liên hệ Hotline/Zalo: 0988.794.264"
                                   Margin="20 20 0 0"
                                   FontSize="20"
                                   />
                    </StackPanel>
                    <Border Grid.Row="1">
                        <Image Source="{DynamicResource IMG_NTechInfo}"
                               Margin="10"
                               Stretch="Uniform" />
                    </Border>
                </Grid>
            </mah:Flyout>
        </mah:FlyoutsControl>
    </mah:MetroWindow.Flyouts>
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="6*" />
            <RowDefinition Height="2.8*" />
            <RowDefinition Height="35" />
        </Grid.RowDefinitions>
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="3*" />
                <ColumnDefinition Width="8*" />
            </Grid.ColumnDefinitions>
            <TreeView x:Name="tvMain"
                      ItemsSource="{Binding LineViewModel.LINEList}"
                      Style="{DynamicResource NTech.Wpf.TreeView}"
                      Margin="2 5 0 0"
                      IsEnabled="{Binding IsLoginSuccess}">
                <i:Interaction.Behaviors>
                    <behaviours:BindableSelectedItemBehavior SelectedItem="{Binding SelectedItem, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType={x:Type behaviours:BindableSelectedItemBehavior}}, Mode=TwoWay}" />
                </i:Interaction.Behaviors>
                <i:Interaction.Triggers>
                    <i:EventTrigger EventName="SelectedItemChanged">
                        <i:InvokeCommandAction Command="{Binding SelectedItemChangeCmd}"
                                               CommandParameter="{Binding ElementName=tvMain, Path=SelectedItem}" />
                    </i:EventTrigger>
                    <i:EventTrigger EventName="PreviewMouseRightButtonDown">
                        <i:InvokeCommandAction Command="{Binding PreviewMouseRightButtonDownCmd}"
                                               CommandParameter="{Binding ElementName=tvMain}" />
                    </i:EventTrigger>
                </i:Interaction.Triggers>
                <TreeView.ItemTemplate>
                    <HierarchicalDataTemplate DataType="{x:Type self:LINE}"
                                              ItemsSource="{Binding Printers}">
                        <StackPanel Orientation="Horizontal">
                            <CheckBox Style="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                      IsChecked="{Binding IsSelected}"
                                      IsEnabled="True" />
                            <TextBlock Text="{Binding LineName}"
                                       Margin="0 0 0 0"
                                       VerticalAlignment="Center"
                                       FontSize="46"
                                       FontWeight="Bold" />
                            <TextBlock Text="(6 máy in, 9 máng xuất)"
                                       VerticalAlignment="Center"
                                       Margin="10 18 0 0"
                                       FontSize="22"
                                       FontWeight="SemiBold" />
                        </StackPanel>
                        <HierarchicalDataTemplate.ItemTemplate>
                            <HierarchicalDataTemplate DataType="{x:Type self:PRINTER}"
                                                      ItemsSource="{Binding Troughs}">
                                <Grid>
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="5*" />
                                        <ColumnDefinition Width="5*" />
                                        <ColumnDefinition Width="8*" />
                                    </Grid.ColumnDefinitions>
                                    <CheckBox Style="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                              IsChecked="{Binding IsSelected}"
                                              IsEnabled="{Binding PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToBooleanConverter}, ConverterParameter='ForCheckbox'}" />
                                    <TextBlock Text="{Binding PrinterName}"
                                               Margin="0 0 0 0"
                                               VerticalAlignment="Center"
                                               FontSize="30"
                                               FontWeight="Bold"
                                               Grid.Column="1" />
                                    <TextBlock Text="{Binding PRINTER_STATES, Converter={StaticResource EnumDescriptionConverter}}"
                                               Visibility="{Binding PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToVisibilityConverter}}"
                                               Margin="10 10 0 0"
                                               VerticalAlignment="Center"
                                               FontSize="18"
                                               FontWeight="SemiBold"
                                               Foreground="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToForegroundConverter}}"
                                               Grid.Column="2" />
                                    <Button Name="btnCoDis"
                                            Visibility="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToVisibility2Converter}, ConverterParameter='1'}"
                                            IsEnabled="{Binding IsSelected}"
                                            Content="{Binding}"
                                            Width="150"
                                            Height="30"
                                            Margin="10 2 0 0"
                                            Foreground="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToForegroundConverter}}"
                                            Background="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToBackgroundConverter}, ConverterParameter='1'}"
                                            Style="{DynamicResource NTech.Wpf.ButtonRoundBound}"
                                            Command="{Binding ConnectPrinterCmd}"
                                            Grid.Column="3">

                                        <Button.ContentTemplate>
                                            <DataTemplate DataType="{x:Type self:PRINTER}">
                                                <StackPanel Orientation="Horizontal">
                                                    <iconPacks:PackIconMaterial Width="12"
                                                                                Height="12"
                                                                                Margin="5 3 0 0"
                                                                                VerticalAlignment="Center"
                                                                                HorizontalAlignment="Center"
                                                                                Foreground="White"
                                                                                Kind="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToIconConverter}}" />
                                                    <TextBlock Margin="8 0 5 0"
                                                               FontSize="14"
                                                               VerticalAlignment="Center"
                                                               Foreground="White"
                                                               Text="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToString2Converter}}" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </Button.ContentTemplate>
                                    </Button>
                                    <ToggleButton x:Name="toggleStartStopPrint"
                                                  Visibility="{Binding PRINTER_STATES, Converter={StaticResource PrinterStateToVisibility2Converter}, ConverterParameter='2'}"
                                                  Style="{DynamicResource NTech.Wpf.ToggleButton2}"
                                                  VerticalAlignment="Center"
                                                  Width="120"
                                                  Height="35"
                                                  Grid.Column="3"
                                                  IsChecked="{Binding PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToBoolean2Converter}, UpdateSourceTrigger=PropertyChanged}"
                                                  IsEnabled="{Binding PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToBooleanConverter}, ConverterParameter='ForToggleButton'}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Checked">
                                                <i:InvokeCommandAction Command="{Binding ToggleCheckedCmd}"
                                                                       CommandParameter="{Binding ElementName=toggleStartStopPrint}" />
                                            </i:EventTrigger>

                                            <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                                                <i:InvokeCommandAction Command="{Binding PreviewMouseLeftButtonDownCmd}"
                                                                       CommandParameter="{Binding ElementName=toggleStartStopPrint}" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ToggleButton>
                                </Grid>
                                <HierarchicalDataTemplate.ItemTemplate>
                                    <DataTemplate DataType="{x:Type self:TROUGH}">
                                        <StackPanel Orientation="Horizontal"
                                                    IsEnabled="{Binding TROUGH_STATES, Converter={StaticResource TroughStateToBooleanConverter}}">
                                            <CheckBox Style="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                      IsChecked="{Binding IsSelected}"
                                                      IsEnabled="{Binding TROUGH_STATES, Converter={StaticResource TroughStateToBooleanConverter}}" />
                                            <TextBlock Text="{Binding TroughName}"
                                                       Margin="0 0 0 0"
                                                       VerticalAlignment="Center"
                                                       FontSize="26"
                                                       FontWeight="SemiBold" />
                                            <TextBlock Text="{Binding TROUGH_STATES, Converter={StaticResource EnumDescriptionConverter}}"
                                                       Visibility="{Binding TROUGH_STATES, Converter={StaticResource TroughStateToVisibilityConverter}}"
                                                       Margin="23 5 0 0"
                                                       VerticalAlignment="Center"
                                                       FontSize="18"
                                                       FontWeight="SemiBold"
                                                       Foreground="{Binding TROUGH_STATES, Converter={StaticResource TroughStateToForegroundConverter}, Mode=OneWay}" />
                                            <mah:ProgressRing Foreground="DodgerBlue"
                                                              IsActive="{Binding TROUGH_STATES, Converter={StaticResource TroughStateToBoolean2Converter}, Mode=OneWay}"
                                                              Background="Transparent"
                                                              Margin="15 0 0 0"
                                                              Height="25"
                                                              Width="25" />
                                        </StackPanel>
                                    </DataTemplate>
                                </HierarchicalDataTemplate.ItemTemplate>
                            </HierarchicalDataTemplate>
                        </HierarchicalDataTemplate.ItemTemplate>
                    </HierarchicalDataTemplate>
                </TreeView.ItemTemplate>
                <!--<TreeViewItem Header="LINE 1"
                              FontSize="46"
                              FontWeight="SemiBold"
                              IsExpanded="False">
                    <TreeViewItem FontWeight="SemiBold">
                        <TreeViewItem.Header>
                            <StackPanel Orientation="Horizontal">
                                <Ellipse Width="30"
                                         Height="30"
                                         Style="{StaticResource NTech.Wpf.Ellipse}" />
                                <TextBlock Margin="5 0 0 0"
                                           Text="MÁY IN 1"
                                           FontSize="36"
                                           VerticalAlignment="Center" />
                                <Image Height="128"
                                       Source="{DynamicResource IMG_Linx_Printer_5900}" />
                            </StackPanel>
                        </TreeViewItem.Header>
                        <TreeViewItem.Items>
                            <StackPanel Orientation="Horizontal"
                                        Margin="0 0 5 0">
                                <Rectangle Style="{StaticResource NTech.Wpf.Rectangle}" />
                                <TextBlock Margin="5 0 0 0"
                                           Text="MÁNG 1"
                                           FontSize="26"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                            <StackPanel Orientation="Horizontal"
                                        Margin="0 0 5 0">
                                <Rectangle Style="{StaticResource NTech.Wpf.Rectangle}" />
                                <TextBlock Margin="5 0 0 0"
                                           Text="MÁNG 2"
                                           FontSize="26"
                                           VerticalAlignment="Center" />
                            </StackPanel>
                        </TreeViewItem.Items>
                    </TreeViewItem>
                </TreeViewItem>-->
            </TreeView>

            <Grid Grid.Column="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2.2*" />
                    <ColumnDefinition Width="1.9*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="3.4*" />
                    <RowDefinition Height="1.2*" />
                </Grid.RowDefinitions>
                <Grid>
                    <GroupBox Margin="2 5 0 0"
                              Header="{Binding}"
                              mah:HeaderedControlHelper.HeaderFontSize="20"
                              mah:HeaderedControlHelper.HeaderFontWeight="SemiBold"
                              IsEnabled="{Binding IsLoginSuccess}">
                        <GroupBox.HeaderTemplate>
                            <DataTemplate DataType="{x:Type vm:MainViewModel}">
                                <StackPanel Orientation="Horizontal">
                                    <TextBlock Text="{Binding LineViewModel.LINESelected.LineName, UpdateSourceTrigger=PropertyChanged}"
                                               Margin="5 0 5 0" />
                                    <TextBlock Text="-"
                                               Margin="5 0 5 0" />
                                    <TextBlock Text="{Binding PrinterViewModel.PRINTERSelected.PrinterName, UpdateSourceTrigger=PropertyChanged}"
                                               Margin="5 0 5 0" />
                                </StackPanel>
                            </DataTemplate>
                        </GroupBox.HeaderTemplate>
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="4*" />
                                <RowDefinition Height="1.7*" />
                            </Grid.RowDefinitions>
                            <mah:MetroTabControl Margin="5"
                                                 Background="#D2DBE4">
                                <mah:MetroTabItem Header="Tình trạng máy in">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="3*" />
                                            <ColumnDefinition Width="7*" />
                                        </Grid.ColumnDefinitions>
                                        <Border Grid.Column="0"
                                                BorderBrush="MidnightBlue"
                                                BorderThickness="5"
                                                CornerRadius="0"
                                                x:Name="bdImage"
                                                Background="{Binding PrinterViewModel.PRINTERSelected.PRINTER_STATES, Converter={StaticResource PrinterStateToBackgroundConverter}, ConverterParameter='2'}"
                                                Margin="5 5 5 0">
                                            <Canvas Width="{Binding ElementName=bdImage, Path=ActualWidth}"
                                                    Height="{Binding ElementName=bdImage, Path=ActualHeight}"
                                                    Name="canvasImage">
                                                <TextBlock Canvas.Left="0"
                                                           Canvas.Top="0"
                                                           Width="110"
                                                           Height="35"
                                                           FontSize="22"
                                                           FontWeight="Bold"
                                                           Foreground="White"
                                                           TextAlignment="Center"
                                                           Background="MidnightBlue"
                                                           Text="{Binding PrinterViewModel.PRINTERSelected.PrinterName}" />
                                                <Image Source="{DynamicResource IMG_Linx_Printer_5900}"
                                                       Name="imgPrinter"
                                                       VerticalAlignment="Center"
                                                       Margin="0 15 0 0"
                                                       Width="{Binding ElementName=canvasImage, Path=ActualWidth}"
                                                       Height="{Binding ElementName=canvasImage, Path=ActualHeight}"
                                                       Stretch="Fill">
                                                    <i:Interaction.Triggers>
                                                        <i:EventTrigger EventName="PreviewMouseLeftButtonDown">
                                                            <i:InvokeCommandAction Command="{Binding PreviewMouseRightButtonDownCmd}"
                                                                                   CommandParameter="{Binding ElementName=imgPrinter}" />
                                                        </i:EventTrigger>
                                                    </i:Interaction.Triggers>
                                                </Image>
                                                <Popup x:Name="popupImgPrinter"
                                                       Placement="MousePoint"
                                                       PlacementTarget="{Binding ElementName=canvasImage}"
                                                       StaysOpen="False"
                                                       VerticalOffset="-10"
                                                       Visibility="{Binding PrinterViewModel.PRINTERSelected.PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToVisibilityConverter}}"
                                                       Closed="popupImgPrinter_Closed">
                                                    <Border BorderBrush="LightGray"
                                                            BorderThickness="1">
                                                        <Grid>
                                                            <Grid.RowDefinitions>
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                                <RowDefinition />
                                                            </Grid.RowDefinitions>
                                                            <Border BorderBrush="LightGray"
                                                                    BorderThickness="1"
                                                                    Background="White">
                                                                <CheckBox Style="{DynamicResource MahApps.Styles.CheckBox.Win10}"
                                                                          Margin="10 0 0 0"
                                                                          Content="Gửi lệnh thủ công"
                                                                          FontSize="16"
                                                                          FontWeight="SemiBold"
                                                                          IsEnabled="False"
                                                                          IsChecked="{Binding PrinterViewModel.IsManual, Mode=TwoWay}" />
                                                            </Border>
                                                            <Button x:Name="btnCheckPrinterState"
                                                                    Content="Kiểm tra trạng thái máy in"
                                                                    Grid.Row="1"
                                                                    Margin="2"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="Green"
                                                                    Foreground="White"
                                                                    Command="{Binding PrinterViewModel.RequestPrintStatusCmd}"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}">
                                                            </Button>
                                                            <Button x:Name="btnStartJet"
                                                                    Visibility="Hidden"
                                                                    Content="Bật tia"
                                                                    Margin="2"
                                                                    Grid.Row="2"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="Crimson"
                                                                    Foreground="White"
                                                                    Command="{Binding PrinterViewModel.StartJetCmd}"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}">
                                                            </Button>
                                                            <Button x:Name="btnStopPrint"
                                                                    Visibility="Hidden"
                                                                    Content="Tắt in"
                                                                    Margin="2"
                                                                    Grid.Row="3"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="Crimson"
                                                                    Foreground="White"
                                                                    Command="{Binding PrinterViewModel.StopPrintCmd}"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}">
                                                            </Button>
                                                            <Button x:Name="btnDisconnect"
                                                                    Visibility="Hidden"
                                                                    Content="Ngắt kết nối"
                                                                    Margin="2"
                                                                    Grid.Row="4"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="Crimson"
                                                                    Foreground="White"
                                                                    Command="{Binding PrinterViewModel.PRINTERSelected.DisconnectPrinterCmd}"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}">
                                                            </Button>
                                                            <Button x:Name="btnTestDownLoadMsg"
                                                                    Visibility="Hidden"
                                                                    Content="Test Download Msg"
                                                                    Command="{Binding PrinterViewModel.DownloadMessageDataCmd}"
                                                                    Margin="2"
                                                                    Grid.Row="5"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="DarkGray"
                                                                    Foreground="White"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}" />
                                                            <Button x:Name="btnTestLoadPrintMsg"
                                                                    Visibility="Hidden"
                                                                    Content="Test Load Print Msg"
                                                                    Command="{Binding PrinterViewModel.LoadPrintMessageCmd}"
                                                                    Margin="2"
                                                                    Grid.Row="6"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="DarkGray"
                                                                    Foreground="White"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}" />
                                                            <Button x:Name="btnDeleteMsg"
                                                                    Visibility="Hidden"
                                                                    Content="Test Delete Msg"
                                                                    Command="{Binding PrinterViewModel.DeleteMessageDataCmd}"
                                                                    Margin="2"
                                                                    Grid.Row="7"
                                                                    FontSize="16"
                                                                    Width="200"
                                                                    Height="30"
                                                                    FontWeight="SemiBold"
                                                                    Background="DarkGray"
                                                                    Foreground="White"
                                                                    Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}" />
                                                            <Border BorderBrush="LightGray"
                                                                    BorderThickness="1"
                                                                    Background="White"
                                                                    Grid.Row="8">
                                                                <CheckBox Style="{DynamicResource MahApps.Styles.CheckBox.Win10}"
                                                                          Margin="10 0 0 0"
                                                                          Content="Liên động"
                                                                          FontSize="16"
                                                                          FontWeight="SemiBold"
                                                                          IsEnabled="True"
                                                                          IsChecked="{Binding PrinterViewModel.PRINTERSelected.IsUseTrough, Mode=TwoWay}" />
                                                            </Border>
                                                        </Grid>
                                                    </Border>

                                                </Popup>
                                            </Canvas>
                                        </Border>
                                        <RichTextBox Grid.Column="1"
                                                     Name="richPrinterState"
                                                     Margin="0 5 0 0"
                                                     VerticalScrollBarVisibility="Auto"
                                                     HorizontalScrollBarVisibility="Auto"
                                                     IsUndoEnabled="False"
                                                     IsReadOnly="True"
                                                     BorderThickness="2"
                                                     IsDocumentEnabled="True"
                                                     Background="#FFF7D6">
                                            <FlowDocument Name="flowDoc"
                                                          PageWidth="{Binding ElementName=richPrinterState, Path=ActualWidth}"
                                                          LineHeight="20"
                                                          LineStackingStrategy="MaxHeight">
                                                <Paragraph Padding="5"
                                                           Margin="0 0 0 0">
                                                    <Run Text="{Binding PrinterViewModel.PRINTERSelected.PrinterStatusDescription}"
                                                         FontSize="18"
                                                         FontWeight="SemiBold"
                                                         Foreground="DarkBlue"
                                                         FontStyle="Italic" />
                                                </Paragraph>
                                            </FlowDocument>
                                        </RichTextBox>
                                    </Grid>
                                </mah:MetroTabItem>
                                <mah:MetroTabItem Header="Thông tin cơ bản">
                                    <Border BorderThickness="1"
                                            BorderBrush="MidnightBlue"
                                            CornerRadius="5"
                                            Margin="5">
                                        <Grid Margin="15">
                                            <Grid.RowDefinitions>
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition />
                                                <RowDefinition Height="2*" />
                                            </Grid.RowDefinitions>
                                            <DockPanel Margin="15 0 0 0"
                                                       LastChildFill="True">
                                                <TextBlock Text="Mã khách hàng:"
                                                           Margin="0 6 0 0"
                                                           FontSize="22"
                                                           FontWeight="SemiBold"
                                                           VerticalAlignment="Center" />
                                                <Label Content="{Binding PrinterViewModel.PRINTERSelected.MessagesDetailModel.CustomerCode}"
                                                       Margin="5 0 0 0"
                                                       FontSize="28"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center" />
                                            </DockPanel>
                                            <DockPanel Margin="15 0 0 0"
                                                       Grid.Row="1"
                                                       LastChildFill="True">
                                                <TextBlock Text="Sản phẩm:"
                                                           Margin="0 6 0 0"
                                                           FontSize="22"
                                                           FontWeight="SemiBold"
                                                           VerticalAlignment="Center" />
                                                <Label Content="{Binding PrinterViewModel.PRINTERSelected.MessagesDetailModel.CementType}"
                                                       Margin="5 0 0 0"
                                                       FontSize="28"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center" />
                                            </DockPanel>
                                            <DockPanel Margin="15 0 0 0"
                                                       Grid.Row="2"
                                                       LastChildFill="True">
                                                <TextBlock Text="Biển số:"
                                                           Margin="0 6 0 0"
                                                           FontSize="22"
                                                           FontWeight="SemiBold"
                                                           VerticalAlignment="Center" />
                                                <Label Content="{Binding PrinterViewModel.PRINTERSelected.MessagesDetailModel.LicensePlate}"
                                                       Margin="5 0 0 0"
                                                       FontSize="28"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center" />
                                            </DockPanel>
                                            <Border Grid.Row="3"
                                                    BorderBrush="MidnightBlue"
                                                    BorderThickness="1"
                                                    CornerRadius="3"
                                                    Margin="0 8 0 0">
                                                <StackPanel Orientation="Vertical">
                                                    <TextBlock Text="Bản tin hiện tại trên máy in:"
                                                               Margin="5 5 0 0"
                                                               FontSize="20"
                                                               FontWeight="Normal"
                                                               VerticalAlignment="Center" />
                                                    <Label Content="{Binding PrinterViewModel.PRINTERSelected.CurrentMessageOnPrinter}"
                                                           FontSize="20"
                                                           FontWeight="SemiBold"
                                                           FontStyle="Italic"
                                                           Foreground="MidnightBlue"
                                                           Margin="15 0 0 0" />
                                                </StackPanel>
                                            </Border>
                                        </Grid>
                                    </Border>
                                </mah:MetroTabItem>
                            </mah:MetroTabControl>
                            <DockPanel LastChildFill="True"
                                       Grid.Row="1">
                                <Label Content="{Binding PrinterViewModel.PRINTERSelected.MessagePrintCount}"
                                       Margin="0 0 30 0"
                                       FontSize="100"
                                       Foreground="Crimson"
                                       FontWeight="SemiBold"
                                       VerticalAlignment="Top"
                                       VerticalContentAlignment="Center"
                                       HorizontalContentAlignment="Center" />
                            </DockPanel>
                        </Grid>
                    </GroupBox>
                </Grid>
                <Grid Grid.Row="1"
                      Grid.Column="0">
                    <GroupBox Header="{Binding PrinterViewModel.PRINTERSelected.LEDTableFixed.TroughName}"
                              HeaderStringFormat="{}NỘI DUNG {0}"
                              Margin="2 5 0 0"
                              mah:HeaderedControlHelper.HeaderFontSize="20"
                              mah:HeaderedControlHelper.HeaderFontWeight="SemiBold">
                        <Border Margin="2"
                                BorderBrush="Black"
                                BorderThickness="2">
                            <Grid>
                                <Grid.RowDefinitions>
                                    <RowDefinition />
                                    <RowDefinition />
                                    <RowDefinition />
                                </Grid.RowDefinitions>
                                <Border BorderBrush="Black"
                                        BorderThickness="0 0 0 2">
                                    <Label Content="{Binding PrinterViewModel.PRINTERSelected.LEDTableFixed.Text1Info}"
                                           FontSize="20"
                                           FontWeight="SemiBold"
                                           Foreground="#D50000"
                                           VerticalContentAlignment="Center"
                                           HorizontalContentAlignment="Center" />
                                </Border>
                                <Border BorderBrush="Black"
                                        BorderThickness="0 0 0 2"
                                        Grid.Row="1">
                                    <Label Content="{Binding PrinterViewModel.PRINTERSelected.LEDTableFixed.Text2Info}"
                                           FontSize="20"
                                           FontWeight="SemiBold"
                                           Foreground="#D50000"
                                           VerticalContentAlignment="Center"
                                           HorizontalContentAlignment="Center" />
                                </Border>
                                <Border Grid.Row="2">
                                    <Label Content="{Binding PrinterViewModel.PRINTERSelected.MessagePrintCountShow}"
                                           FontSize="24"
                                           FontWeight="SemiBold"
                                           Foreground="#D50000"
                                           VerticalContentAlignment="Center"
                                           HorizontalContentAlignment="Center" />
                                </Border>
                            </Grid>
                        </Border>
                    </GroupBox>
                </Grid>
                <Grid Grid.Column="1"
                      Grid.RowSpan="2">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="8.5*" />
                            <RowDefinition Height="2.6*" />
                        </Grid.RowDefinitions>
                        <Grid>
                            <GroupBox Header="{Binding}"
                                      Margin="2 5 0 0"
                                      mah:HeaderedControlHelper.HeaderFontSize="20"
                                      mah:HeaderedControlHelper.HeaderFontWeight="SemiBold"
                                      IsEnabled="{Binding IsLoginSuccess}">
                                <GroupBox.HeaderTemplate>
                                    <DataTemplate DataType="{x:Type vm:MainViewModel}">
                                        <StackPanel Orientation="Horizontal">
                                            <TextBlock Text="THÔNG SỐ BẢN TIN"
                                                       Margin="5 0 5 0" />
                                            <TextBlock Text="-"
                                                       Margin="5 0 5 0" />
                                            <TextBlock Text="{Binding PrinterViewModel.PRINTERSelected.MESSAGE_STATE, Converter={StaticResource EnumDescriptionConverter}}"
                                                       Margin="5 0 5 0"
                                                       FontStyle="Italic"
                                                       Foreground="{Binding PrinterViewModel.PRINTERSelected.MESSAGE_STATE, Converter={StaticResource MessageStateToForegroundConverter}}" />
                                        </StackPanel>
                                    </DataTemplate>
                                </GroupBox.HeaderTemplate>
                                <Grid Margin="5">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="1.25*" />
                                    </Grid.ColumnDefinitions>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="*" />
                                        <RowDefinition Height="1.5*" />
                                    </Grid.RowDefinitions>
                                    <DockPanel Grid.Row="0"
                                               Grid.Column="0"
                                               Margin="20 0 0 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Số phiếu:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.CouponCode}"
                                               VerticalContentAlignment="Center"
                                               Margin="5 0 20 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="1"
                                               Grid.Column="0"
                                               Margin="20 0 0 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Biển số:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.LicensePlate}"
                                               VerticalContentAlignment="Center"
                                               Margin="20 0 20 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="2"
                                               Grid.Column="0"
                                               Margin="20 0 0 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Số tấn:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center"/>
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.WeightTon}"
                                               VerticalContentAlignment="Center"
                                               Margin="30 0 20 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="3"
                                               Grid.Column="0"
                                               Margin="20 0 0 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Số bao:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.NumberBags}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Stretch"
                                               VerticalContentAlignment="Center"
                                               HorizontalContentAlignment="Center"
                                               Margin="25 0 20 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="4"
                                               Grid.Column="0"
                                               Margin="20 0 0 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Số bao đã in:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.NumberBagsPrinted}"
                                               VerticalAlignment="Center"
                                               HorizontalAlignment="Stretch"
                                               VerticalContentAlignment="Center"
                                               HorizontalContentAlignment="Center"
                                               Margin="28 0 20 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="0"
                                               Grid.Column="1"
                                               Margin="20 0 0 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Loại vỏ bao:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.BagCoverType}"
                                               VerticalContentAlignment="Center"
                                               Margin="30 0 15 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="1"
                                               Grid.Column="1"
                                               Margin="20 0 10 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Loại xi măng:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.CementType}"
                                               VerticalContentAlignment="Center"
                                               Margin="20 0 5 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="2"
                                                Grid.Column="1"
                                                Margin="20 0 10 0"
                                                LastChildFill="True">
                                        <TextBlock Text="Thương hiệu:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.Brand}"
                                               VerticalContentAlignment="Center"
                                               Margin="23 0 5 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="3"
                                                Grid.Column="1"
                                                Margin="20 0 5 0"
                                                LastChildFill="True">
                                        <TextBlock Text="Cách xếp hàng:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.ArrangeType}"
                                               VerticalContentAlignment="Center"
                                               Margin="5 0 5 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="4"
                                               Grid.Column="1"
                                               Margin="20 0 10 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Ca sản xuất:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <Label Height="40"
                                               Content="{Binding MessagesDetailModel.ManufacturingShift}"
                                               VerticalContentAlignment="Center"
                                               Margin="35 0 0 0"
                                               FontSize="20"
                                               FontWeight="Bold"
                                               Background="AliceBlue" />
                                    </DockPanel>
                                    <DockPanel Grid.Row="5"
                                               Grid.Column="0"
                                               Grid.ColumnSpan="2"
                                               Margin="20 0 10 0"
                                               LastChildFill="True">
                                        <TextBlock Text="Ngày sản xuất:"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                        <TextBlock Text="{Binding Source={x:Static System:DateTime.Today}, StringFormat='{}{0:dddd, dd-MM-yyyy}'}"
                                                   Margin="20 0 0 0"
                                                   IsEnabled="False"
                                                   Foreground="Gray"
                                                   FontSize="20"
                                                   FontWeight="SemiBold"
                                                   VerticalAlignment="Center" />
                                    </DockPanel>
                                    <Border Grid.Row="6"
                                            Grid.Column="0"
                                            Grid.ColumnSpan="2"
                                            Margin="5 0 5 0"
                                            BorderThickness="1"
                                            BorderBrush="#90A4AE"
                                            CornerRadius="5">
                                        <StackPanel Orientation="Vertical"
                                                    Margin="20 10 5 5">
                                            <TextBlock Text="Thông tin gửi máy in:"
                                                       FontSize="20"
                                                       FontWeight="SemiBold"
                                                       VerticalAlignment="Center" />
                                            <Label Height="40"
                                                   Content="{Binding PrinterViewModel.PRINTERSelected.TextInfoSendToPrinter}"
                                                   VerticalContentAlignment="Center"
                                                   Margin="0 0 0 0"
                                                   FontSize="26"
                                                   FontWeight="SemiBold"
                                                   FontStyle="Normal"
                                                   Foreground="#0091EA" />
                                        </StackPanel>
                                    </Border>

                                </Grid>
                            </GroupBox>
                        </Grid>
                        <Grid Grid.Row="1">
                            <Border Margin="2 5 2 0"
                                    BorderBrush="MidnightBlue"
                                    BorderThickness="1"
                                    CornerRadius="5"
                                    IsEnabled="{Binding IsLoginSuccess}">
                                <Grid>
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="1.5*" />
                                        <RowDefinition Height="2.5*" />
                                    </Grid.RowDefinitions>
                                    <DockPanel LastChildFill="True"
                                               Margin="2">
                                        <ComboBox Name="cbbShift"
                                                  IsReadOnly="True"
                                                  IsEnabled="False"
                                                  FontSize="18"
                                                  FontWeight="SemiBold"
                                                  Margin="2 0 0 0"
                                                  Style="{DynamicResource NTech.Wpf.ComboBox}"
                                                  Padding="15,5,15,5"
                                                  VerticalAlignment="Center"
                                                  MinWidth="100"
                                                  MaxWidth="375"
                                                  Height="45"
                                                  ItemContainerStyle="{DynamicResource NTech.Wpf.ComboBoxItem}">
                                            <ComboBoxItem>Ca 1</ComboBoxItem>
                                            <ComboBoxItem>Ca 2</ComboBoxItem>
                                            <ComboBoxItem>Ca 3</ComboBoxItem>
                                        </ComboBox>
                                        <ComboBox Name="cbbLINE"
                                                  IsReadOnly="True"
                                                  IsEnabled="False"
                                                  FontSize="18"
                                                  FontWeight="SemiBold"
                                                  Margin="5 0 0 0"
                                                  Style="{DynamicResource NTech.Wpf.ComboBox}"
                                                  Padding="15,5,15,5"
                                                  VerticalAlignment="Center"
                                                  MinWidth="180"
                                                  MaxWidth="375"
                                                  Height="45"
                                                  ItemsSource="{Binding LineViewModel.LINESName}"
                                                  SelectedItem="{Binding LineViewModel.LINESelected.LineName, UpdateSourceTrigger=PropertyChanged}"
                                                  ItemContainerStyle="{DynamicResource NTech.Wpf.ComboBoxItem}">
                                        </ComboBox>
                                        <ComboBox Name="cbbPRINTER"
                                                  IsReadOnly="True"
                                                  IsEnabled="False"
                                                  FontSize="18"
                                                  FontWeight="SemiBold"
                                                  Margin="5 0 0 0"
                                                  Style="{DynamicResource NTech.Wpf.ComboBox}"
                                                  Padding="15,5,15,5"
                                                  VerticalAlignment="Center"
                                                  MinWidth="180"
                                                  MaxWidth="375"
                                                  Height="45"
                                                  ItemsSource="{Binding PrinterViewModel.PRINTERSName}"
                                                  SelectedItem="{Binding PrinterViewModel.PRINTERSelected.PrinterName}"
                                                  ItemContainerStyle="{DynamicResource NTech.Wpf.ComboBoxItem}">
                                        </ComboBox>
                                        <ComboBox Name="cbbTROUGH"
                                                  IsReadOnly="True"
                                                  IsEnabled="False"
                                                  FontSize="18"
                                                  FontWeight="SemiBold"
                                                  Margin="5 0 2 0"
                                                  Style="{DynamicResource NTech.Wpf.ComboBox}"
                                                  Padding="15,5,15,5"
                                                  VerticalAlignment="Center"
                                                  MinWidth="100"
                                                  MaxWidth="375"
                                                  Height="45"
                                                  ItemsSource="{Binding TroughViewModel.TROUGHSName}"
                                                  SelectedItem="{Binding TroughViewModel.TROUGHSelected.TroughName}"
                                                  ItemContainerStyle="{DynamicResource NTech.Wpf.ComboBoxItem}">
                                        </ComboBox>
                                    </DockPanel>
                                    <StackPanel Orientation="Horizontal"
                                                Margin="2"
                                                Grid.Row="1"
                                                HorizontalAlignment="Right">
                                        <Button Content="NẠP BẢN TIN"
                                                Width="175"
                                                Height="70"
                                                Background="MidnightBlue"
                                                Command="{Binding PushMessageAndContentLEDCmd}"
                                                Style="{DynamicResource NTech.Wpf.ButtonRoundBound}">
                                            <Button.IsEnabled>
                                                <MultiBinding Converter="{StaticResource MultiBoleanConverter}"
                                                              Mode="OneWay">
                                                    <Binding Path="IsCanStart" />
                                                    <Binding Path="IsMessagePrintedDone" />
                                                    <Binding Path="IsReprint" />
                                                </MultiBinding>
                                            </Button.IsEnabled>
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <iconPacks:PackIconMaterial Width="16"
                                                                                    Height="16"
                                                                                    Margin="0 3 0 0"
                                                                                    VerticalAlignment="Center"
                                                                                    HorizontalAlignment="Center"
                                                                                    Foreground="Orange"
                                                                                    Kind="Download" />
                                                        <TextBlock Margin="5 0 5 0"
                                                                   FontSize="22"
                                                                   VerticalAlignment="Center"
                                                                   Foreground="White"
                                                                   Text="{Binding}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                        <Button Content="HỦY"
                                                Width="150"
                                                Height="70"
                                                Margin="5 0 5 0"
                                                Background="MidnightBlue"
                                                Command="{Binding CancelSelectionsCmd}"
                                                Style="{DynamicResource NTech.Wpf.ButtonRoundBound}">
                                            <Button.ContentTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <iconPacks:PackIconMaterial Width="16"
                                                                                    Height="16"
                                                                                    Margin="0 3 0 0"
                                                                                    VerticalAlignment="Center"
                                                                                    HorizontalAlignment="Center"
                                                                                    Foreground="Crimson"
                                                                                    Kind="Cancel" />
                                                        <TextBlock Margin="5 0 5 0"
                                                                   FontSize="22"
                                                                   VerticalAlignment="Center"
                                                                   Foreground="White"
                                                                   Text="{Binding}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                            </Button.ContentTemplate>
                                        </Button>
                                    </StackPanel>
                                </Grid>
                            </Border>
                        </Grid>
                    </Grid>
                </Grid>
            </Grid>
        </Grid>
        <Grid Grid.Row="1">
            <Border BorderThickness="2"
                    BorderBrush="MidnightBlue"
                    CornerRadius="5"
                    IsEnabled="{Binding IsLoginSuccess}">
                <mah:MetroTabControl SelectionChanged="MetroTabControl_SelectionChanged"
                                     Background="#D2DBE4">
                    <TabItem Header="Bản tin mới">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="40" />
                                <RowDefinition />
                            </Grid.RowDefinitions>
                            <StackPanel Orientation="Horizontal"
                                        HorizontalAlignment="Left">
                                <TextBox x:Name="txtSearchNewMsg"
                                         TextChanged="txtSearchNewMsg_TextChanged"
                                         MinWidth="550"
                                         Margin="20 0 0 0"
                                         mah:TextBoxHelper.Watermark="Nhập số phiếu"
                                         mah:TextBoxHelper.ClearTextButton="True"
                                         Style="{DynamicResource NTech.Base.Wpf.Styles.TextBox.Search}"
                                         FontSize="20"
                                         FontWeight="SemiBold"
                                         VerticalContentAlignment="Center"
                                         HorizontalContentAlignment="Left" />
                            </StackPanel>
                            <DataGrid Name="dgNewMessages"
                                      Grid.Row="1"
                                      Margin="8"
                                      FontSize="22"
                                      GridLinesVisibility="All"
                                      AutoGenerateColumns="False"
                                      RenderOptions.ClearTypeHint="Enabled"
                                      SelectionUnit="FullRow"
                                      TextOptions.TextFormattingMode="Display"
                                      CanUserAddRows="False"
                                      CanUserReorderColumns="False"
                                      CanUserResizeColumns="False"
                                      CanUserResizeRows="False"
                                      EnableColumnVirtualization="True"
                                      EnableRowVirtualization="True"
                                      search:DataGridTextSearch.SearchValue="{Binding ElementName=txtSearchNewMsg, Path=Text, UpdateSourceTrigger=PropertyChanged}"
                                      IsEnabled="{Binding PrinterViewModel.PRINTERSelected.PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToBoolean3Converter}}"
                                      SelectedItem="{Binding MessagesDetailModel, Mode=TwoWay}"
                                      ItemsSource="{Binding NewMessagesDetailList}"
                                      Style="{StaticResource MahApps.Styles.DataGrid.Azure}">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type DataGridCell}">
                                        <Setter Property="search:DataGridTextSearch.IsTextMatch">
                                            <Setter.Value>
                                                <MultiBinding Converter="{StaticResource SearchValueConverter}">
                                                    <Binding RelativeSource="{RelativeSource Self}"
                                                             Path="Content.Text" />
                                                    <Binding RelativeSource="{RelativeSource Self}"
                                                             Path="(search:DataGridTextSearch.SearchValue)" />
                                                </MultiBinding>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <!--<Trigger Property="search:DataGridTextSearch.IsTextMatch"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="Orange" />
                                            </Trigger>-->
                                            <Trigger Property="search:DataGridTextSearch.IsTextMatch"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="Orange" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.Resources>
                                <DataGrid.Columns>
                                    <DataGridCheckBoxColumn Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected, Mode=OneWay}"
                                                            EditingElementStyle="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                            ElementStyle="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                            Header="" />
                                    <DataGridTextColumn Header="Ngày SX"
                                                        FontSize="16"
                                                        Binding="{Binding ManufacturingDate}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Thời gian SX"
                                                        FontSize="16"
                                                        Binding="{Binding ManufacturingTime}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Ca SX"
                                                        FontSize="16"
                                                        Binding="{Binding ManufacturingShift}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số phiếu"
                                                        FontSize="16"
                                                        Binding="{Binding CouponCode}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Biển số"
                                                        FontSize="16"
                                                        Binding="{Binding LicensePlate}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Mã khách hàng"
                                                        FontSize="16"
                                                        Binding="{Binding CustomerCode}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Tên khách hàng"
                                                        FontSize="16"
                                                        Binding="{Binding CustomerName}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Loại xi măng"
                                                        FontSize="16"
                                                        Binding="{Binding CementType}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số tấn"
                                                        FontSize="16"
                                                        Binding="{Binding WeightTon}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số bao"
                                                        FontSize="16"
                                                        Binding="{Binding NumberBags}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số bao đã in"
                                                        FontSize="16"
                                                        Binding="{Binding NumberBagsPrinted}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Loại vỏ bao"
                                                        FontSize="16"
                                                        Binding="{Binding BagCoverType}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Thương hiệu"
                                                        FontSize="16"
                                                        Binding="{Binding Brand}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Kiểu xếp hàng"
                                                        FontSize="16"
                                                        Binding="{Binding ArrangeType}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Line"
                                                        FontSize="16"
                                                        Binding="{Binding Line}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False"
                                                        mah:TextBoxHelper.Watermark="trống" />
                                    <DataGridTextColumn Header="Máy in"
                                                        FontSize="16"
                                                        Binding="{Binding Printer}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False"
                                                        mah:TextBoxHelper.Watermark="trống" />
                                    <DataGridTextColumn Header="Máng"
                                                        FontSize="16"
                                                        Binding="{Binding Trough}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False"
                                                        mah:TextBoxHelper.Watermark="trống" />
                                    <DataGridTextColumn Header="Trạng thái bản tin"
                                                        FontSize="16"
                                                        Binding="{Binding MessageState}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                </DataGrid.Columns>
                            </DataGrid>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Bản tin đang in">
                        <DataGrid Name="dgPrintingMessages"
                                  Margin="8"
                                  FontSize="22"
                                  GridLinesVisibility="All"
                                  AutoGenerateColumns="False"
                                  RenderOptions.ClearTypeHint="Enabled"
                                  SelectionUnit="FullRow"
                                  TextOptions.TextFormattingMode="Display"
                                  CanUserAddRows="False"
                                  CanUserReorderColumns="False"
                                  CanUserResizeColumns="False"
                                  CanUserResizeRows="False"
                                  EnableColumnVirtualization="True"
                                  EnableRowVirtualization="True"
                                  ItemsSource="{Binding PrintingMessagesDetailList}"
                                  Style="{StaticResource MahApps.Styles.DataGrid.Azure}">
                            <DataGrid.Columns>
                                <!--<DataGridCheckBoxColumn Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected, Mode=OneWay}"
                                                            EditingElementStyle="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                            ElementStyle="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                            Header="" />-->
                                <DataGridTextColumn Header="Ngày SX"
                                                    FontSize="16"
                                                    Binding="{Binding ManufacturingDate}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Thời gian SX"
                                                    FontSize="16"
                                                    Binding="{Binding ManufacturingTime}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Ca SX"
                                                    FontSize="16"
                                                    Binding="{Binding ManufacturingShift}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Số phiếu"
                                                    FontSize="16"
                                                    Binding="{Binding CouponCode}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Biển số"
                                                    FontSize="16"
                                                    Binding="{Binding LicensePlate}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Mã khách hàng"
                                                    FontSize="16"
                                                    Binding="{Binding CustomerCode}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Tên khách hàng"
                                                    FontSize="16"
                                                    Binding="{Binding CustomerName}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Loại xi măng"
                                                    FontSize="16"
                                                    Binding="{Binding CementType}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Số tấn"
                                                    FontSize="16"
                                                    Binding="{Binding WeightTon}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Số bao"
                                                    FontSize="16"
                                                    Binding="{Binding NumberBags}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Số bao đã in"
                                                    FontSize="16"
                                                    Binding="{Binding NumberBagsPrinted}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Loại vỏ bao"
                                                    FontSize="16"
                                                    Binding="{Binding BagCoverType}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Thương hiệu"
                                                    FontSize="16"
                                                    Binding="{Binding Brand}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Kiểu xếp hàng"
                                                    FontSize="16"
                                                    Binding="{Binding ArrangeType}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                                <DataGridTextColumn Header="Line"
                                                    FontSize="16"
                                                    Binding="{Binding Line}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False"
                                                    mah:TextBoxHelper.Watermark="trống" />
                                <DataGridTextColumn Header="Máy in"
                                                    FontSize="16"
                                                    Binding="{Binding Printer}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False"
                                                    mah:TextBoxHelper.Watermark="trống" />
                                <DataGridTextColumn Header="Máng"
                                                    FontSize="16"
                                                    Binding="{Binding Trough}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False"
                                                    mah:TextBoxHelper.Watermark="trống" />
                                <DataGridTextColumn Header="Trạng thái bản tin"
                                                    FontSize="16"
                                                    Binding="{Binding MessageState}"
                                                    IsReadOnly="True"
                                                    mah:TextBoxHelper.ClearTextButton="False" />
                            </DataGrid.Columns>
                        </DataGrid>
                    </TabItem>
                    <TabItem Header="Bản tin đã in">
                        <Grid>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="40" />
                                <RowDefinition />
                            </Grid.RowDefinitions>

                            <StackPanel Orientation="Horizontal"
                                        Width="auto"
                                        Margin="0 5 0 0">
                                <TextBlock Text="Chọn ngày :"
                                           Margin="20 0 0 0"
                                           FontSize="16"
                                           FontWeight="SemiBold"
                                           VerticalAlignment="Center" />
                                <Border BorderBrush="LightGray"
                                        BorderThickness="1"
                                        CornerRadius="5"
                                        Margin="5 0 5 0">
                                    <Controls:CalendarControl Width="auto"
                                                              Height="30"
                                                              VerticalAlignment="Center"
                                                              Margin="10 0 0 0" />
                                </Border>
                                <Border BorderBrush="LightGray"
                                        BorderThickness="1"
                                        CornerRadius="5">
                                    <CheckBox Style="{DynamicResource MahApps.Styles.CheckBox.Win10}"
                                              Content="{Binding LineViewModel.LINEByUse.LineName}"
                                              ContentStringFormat="{}Chỉ chọn {0}"
                                              FontSize="16"
                                              FontWeight="SemiBold"
                                              Padding="5"
                                              Margin="5 0 2 0"
                                              IsChecked="{Binding IsOnlyLINE, Mode=TwoWay}" />

                                </Border>
                                <Button x:Name="btnSearch"
                                        Margin="10 0 0 0"
                                        Width="120"
                                        Content="{Binding}"
                                        Command="{Binding SearchCmd}"
                                        Style="{DynamicResource NTech.Wpf.ButtonRoundBound}">
                                    <Button.Background>
                                        <LinearGradientBrush EndPoint="0.5,1"
                                                             StartPoint="0.5,0">
                                            <LinearGradientBrush.RelativeTransform>
                                                <TransformGroup>
                                                    <ScaleTransform CenterY="0.5"
                                                                    CenterX="0.5" />
                                                    <SkewTransform CenterX="0.5"
                                                                   CenterY="0.5" />
                                                    <RotateTransform Angle="90"
                                                                     CenterX="0.5"
                                                                     CenterY="0.5" />
                                                    <TranslateTransform />
                                                </TransformGroup>
                                            </LinearGradientBrush.RelativeTransform>
                                            <GradientStop Color="#FFECB742" />
                                            <GradientStop Color="#FFF7AE09"
                                                          Offset="1" />
                                        </LinearGradientBrush>
                                    </Button.Background>
                                    <Button.ContentTemplate>
                                        <DataTemplate>
                                            <StackPanel Orientation="Horizontal">
                                                <Image Source="{DynamicResource IMG_IC_Search}"
                                                       Width="26"
                                                       Height="26"
                                                       VerticalAlignment="Center" />
                                                <TextBlock Margin="2 0 0 0"
                                                           Text="Tìm kiếm"
                                                           FontSize="16"
                                                           FontWeight="SemiBold"
                                                           Foreground="White"
                                                           TextAlignment="Center"
                                                           VerticalAlignment="Center" />
                                            </StackPanel>
                                        </DataTemplate>
                                    </Button.ContentTemplate>
                                </Button>
                                <TextBox x:Name="txtSearchPrintedMsg"
                                         TextChanged="txtSearchPrintedMsg_TextChanged"
                                         MinWidth="550"
                                         Margin="50 0 0 0"
                                         mah:TextBoxHelper.Watermark="Nhập số phiếu"
                                         mah:TextBoxHelper.ClearTextButton="True"
                                         DockPanel.Dock="Right"
                                         Style="{DynamicResource NTech.Base.Wpf.Styles.TextBox.Search}"
                                         FontSize="20"
                                         VerticalContentAlignment="Center"
                                         HorizontalContentAlignment="Left" />
                            </StackPanel>
                            <DataGrid Name="dgPrintedMessages"
                                      Grid.Row="1"
                                      Margin="8"
                                      FontSize="22"
                                      GridLinesVisibility="All"
                                      AutoGenerateColumns="False"
                                      RenderOptions.ClearTypeHint="Enabled"
                                      SelectionUnit="FullRow"
                                      TextOptions.TextFormattingMode="Display"
                                      CanUserAddRows="False"
                                      CanUserReorderColumns="False"
                                      CanUserResizeColumns="False"
                                      CanUserResizeRows="False"
                                      EnableColumnVirtualization="True"
                                      EnableRowVirtualization="True"
                                      search:DataGridTextSearch.SearchValue="{Binding ElementName=txtSearchPrintedMsg, Path=Text, UpdateSourceTrigger=PropertyChanged}"
                                      IsEnabled="{Binding PrinterViewModel.PRINTERSelected.PRINTER_STATES, Mode=OneWay, Converter={StaticResource PrinterStateToBoolean3Converter}}"
                                      SelectedItem="{Binding MessagesDetailModelHistory, Mode=TwoWay}"
                                      ItemsSource="{Binding AllMessagesDetailList}"
                                      Style="{StaticResource MahApps.Styles.DataGrid.Azure}"
                                      SelectionChanged="dgPrintedMessages_SelectionChanged">
                                <DataGrid.Resources>
                                    <Style TargetType="{x:Type DataGridCell}">
                                        <Setter Property="search:DataGridTextSearch.IsTextMatch">
                                            <Setter.Value>
                                                <MultiBinding Converter="{StaticResource SearchValueConverter}">
                                                    <Binding RelativeSource="{RelativeSource Self}"
                                                             Path="Content.Text" />
                                                    <Binding RelativeSource="{RelativeSource Self}"
                                                             Path="(search:DataGridTextSearch.SearchValue)" />
                                                </MultiBinding>
                                            </Setter.Value>
                                        </Setter>
                                        <Style.Triggers>
                                            <!--<Trigger Property="search:DataGridTextSearch.IsTextMatch"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="Orange" />
                                            </Trigger>-->
                                            <Trigger Property="search:DataGridTextSearch.IsTextMatch"
                                                     Value="True">
                                                <Setter Property="Background"
                                                        Value="Orange" />
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.Resources>
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="PreviewMouseRightButtonDown">
                                        <i:InvokeCommandAction Command="{Binding PreviewMouseRightButtonDownCmd}"
                                                               CommandParameter="{Binding ElementName=dgPrintedMessages}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                                <DataGrid.Columns>
                                    <DataGridCheckBoxColumn Binding="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=IsSelected, Mode=OneWay}"
                                                            EditingElementStyle="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                            ElementStyle="{DynamicResource MahApps.Styles.CheckBox.DataGrid.Win10}"
                                                            Header="" />
                                    <DataGridTextColumn Header="Ngày SX"
                                                        FontSize="16"
                                                        Binding="{Binding ManufacturingDate}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Thời gian SX"
                                                        FontSize="16"
                                                        Binding="{Binding ManufacturingTime}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Ca SX"
                                                        FontSize="16"
                                                        Binding="{Binding ManufacturingShift}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số phiếu"
                                                        FontSize="16"
                                                        Binding="{Binding CouponCode}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Biển số"
                                                        FontSize="16"
                                                        Binding="{Binding LicensePlate}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Mã khách hàng"
                                                        FontSize="16"
                                                        Binding="{Binding CustomerCode}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Tên khách hàng"
                                                        FontSize="16"
                                                        Binding="{Binding CustomerName}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Loại xi măng"
                                                        FontSize="16"
                                                        Binding="{Binding CementType}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số tấn"
                                                        FontSize="16"
                                                        Binding="{Binding WeightTon}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số bao"
                                                        FontSize="16"
                                                        Binding="{Binding NumberBags}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Số bao đã in"
                                                        FontSize="16"
                                                        Binding="{Binding NumberBagsPrinted}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Loại vỏ bao"
                                                        FontSize="16"
                                                        Binding="{Binding BagCoverType}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Thương hiệu"
                                                        FontSize="16"
                                                        Binding="{Binding Brand}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Kiểu xếp hàng"
                                                        FontSize="16"
                                                        Binding="{Binding ArrangeType}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Line"
                                                        FontSize="16"
                                                        Binding="{Binding Line}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False"
                                                        mah:TextBoxHelper.Watermark="trống" />
                                    <DataGridTextColumn Header="Máy in"
                                                        FontSize="16"
                                                        Binding="{Binding Printer}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False"
                                                        mah:TextBoxHelper.Watermark="trống" />
                                    <DataGridTextColumn Header="Máng"
                                                        FontSize="16"
                                                        Binding="{Binding Trough}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False"
                                                        mah:TextBoxHelper.Watermark="trống" />
                                    <DataGridTextColumn Header="Trạng thái bản tin"
                                                        FontSize="16"
                                                        Binding="{Binding MessageState}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                    <DataGridTextColumn Header="Ghi chú"
                                                        FontSize="16"
                                                        Binding="{Binding Note}"
                                                        IsReadOnly="True"
                                                        mah:TextBoxHelper.ClearTextButton="False" />
                                </DataGrid.Columns>
                            </DataGrid>
                            <Popup x:Name="popupDG"
                                   Placement="MousePoint"
                                   PlacementTarget="{Binding ElementName=dgPrintedMessages, Path=SelectedItem}"
                                   StaysOpen="False"
                                   VerticalOffset="-8">
                                <Border BorderBrush="LightGray"
                                        BorderThickness="1">
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition />
                                            <RowDefinition />
                                            <RowDefinition />
                                        </Grid.RowDefinitions>
                                        <Button x:Name="btnReprint"
                                                Content="In lại bản tin này"
                                                Margin="2"
                                                FontSize="16"
                                                Width="200"
                                                Height="30"
                                                FontWeight="SemiBold"
                                                Background="Crimson"
                                                Foreground="White"
                                                Command="{Binding ReprintCmd}"
                                                Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}">
                                        </Button>
                                        <Button x:Name="btnEdit"
                                                Grid.Row="1"
                                                Content="Chỉnh sửa bản tin này"
                                                Margin="2"
                                                FontSize="16"
                                                Width="200"
                                                Height="30"
                                                FontWeight="SemiBold"
                                                Background="#2196F3"
                                                Foreground="White"
                                                Command="{Binding EditMessagePrintedCmd}"
                                                Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}">
                                        </Button>
                                        <Button x:Name="btnCancel"
                                                Content="Hủy"
                                                Margin="2"
                                                Grid.Row="2"
                                                FontSize="16"
                                                Width="200"
                                                Height="30"
                                                FontWeight="SemiBold"
                                                Background="Gray"
                                                Foreground="White"
                                                Click="btnCancel_Click"
                                                Style="{StaticResource MahApps.Styles.Button.MetroWindow.Base}" />
                                    </Grid>
                                </Border>

                            </Popup>
                        </Grid>
                    </TabItem>
                    <TabItem Header="Nhật ký">
                        <Border BorderThickness="0,1"
                                BorderBrush="Gray"
                                Margin="5">
                            <RichTextBox x:Name="rtbLog"
                                         ScrollViewer.VerticalScrollBarVisibility="Auto"
                                         IsUndoEnabled="False"
                                         IsReadOnly="True"
                                         BorderThickness="2"
                                         IsDocumentEnabled="True"
                                         Background="Transparent">
                                <FlowDocument Name="flowLog"
                                              PageWidth="{Binding ElementName=rtbLog, Path=ActualWidth}"
                                              LineHeight="20"
                                              LineStackingStrategy="MaxHeight">
                                    <Paragraph Name="paraLog"
                                               Padding="5"
                                               Margin="5 0 0 0"
                                               FontSize="16"
                                               FontWeight="Normal"
                                               Foreground="Black"
                                               FontStyle="Italic">
                                    </Paragraph>
                                </FlowDocument>
                            </RichTextBox>
                        </Border>
                    </TabItem>
                </mah:MetroTabControl>
            </Border>
        </Grid>
        <Grid Grid.Row="2">
            <StatusBar Margin="2 0 0 0"
                       FontSize="16">
                <StatusBarItem Content="{Binding AppVersion}"
                               ContentStringFormat="{}Phần mềm trạm điều khiển v{0}" />
                <Separator Style="{DynamicResource MahApps.Styles.Separator.StatusBar}" />
                <StatusBarItem Content="{Binding ConnectionState}" />
                <Separator Style="{DynamicResource MahApps.Styles.Separator.StatusBar}" />
                <StatusBarItem Content="{Binding PrinterViewModel.PRINTERSelected.NotifyMsgOfPrinter}" />
                <Separator Style="{DynamicResource MahApps.Styles.Separator.StatusBar}" />
                <Button Width="150"
                        Height="25"
                        Content="Test"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        FontSize="14"
                        Click="Button_Click"
                        Visibility="Collapsed" />
            </StatusBar>
        </Grid>
    </Grid>
</mah:MetroWindow >
